# CanvasLayer

**CanvasLayer** es un nodo especial que crea una “capa de dibujo” 2D independiente, donde todo lo que sea hijo suyo se renderiza por separado del resto de la escena y con una prioridad de dibujo propia. Se usa sobre todo para HUD, interfaces, fondos y efectos que deben mantenerse fijos en pantalla o en un orden visual muy concreto.

## Definición básica

- CanvasLayer hereda de Node y sirve para renderizar nodos 2D (CanvasItem: Node2D, Control, etc.) en una capa propia.
- Todos los hijos directos o indirectos de un CanvasLayer se dibujan en esa misma capa, independientemente de dónde estén en el árbol de la escena principal.

## Orden de dibujo (layer index)

- El orden se controla con una propiedad numérica **`layer`** (un entero, puede ser negativo).
- La escena 2D “normal” se dibuja en la capa 0; una CanvasLayer con **`layer = -1`** se dibuja por debajo y una con **`layer = 1`** por encima de la escena.
- El **`z_index`** de los CanvasItem sólo ordena dentro de la misma capa; el número de **`layer`** decide qué capa va primero o después.

## Transformaciones independientes

- Cada CanvasLayer tiene su propia transformación 2D (posición, rotación, escala) independiente de otras capas.
- Esto permite que, por ejemplo, la cámara mueva el mundo (capa 0) mientras la UI en un CanvasLayer con **`follow_viewport`** fijo no se mueve en pantalla.

## Usos típicos

- HUD y UI fija: barras de vida, marcadores, menús superpuestos en capas **`1`** o superiores, siempre visibles sobre el mundo.
- Fondos y parallax: poner un CanvasLayer con **`layer = -1`** para fondos que van debajo del mundo y se pueden mover a distinta velocidad.
- Efectos especiales o overlays: pantallas de pausa, viñetas, marcos, mensajes flotantes que deben dibujarse encima de todo.

## Propiedades clave para tu nota

- **`layer`**: índice de capa; valores más bajos se dibujan primero, los más altos por encima.
- Transform/offset: permite desplazar o escalar toda la capa sin modificar cada nodo hijo.
- Seguir o no al viewport (en Godot 4, opciones relacionadas con seguir la cámara/viewport) para decidir si la capa es “del mundo” o “de la pantalla”.