# FileAccess

Es la clase de Godot 4 para leer y escribir archivos (texto o binario) en rutas como **`res://`** y **`user://`**, y se usa sobre todo para sistemas de guardado, configuración y logs.

---

## Concepto básico

- Se usa mediante métodos estáticos como **`FileAccess.open(path, mode)`** que devuelven un objeto de tipo FileAccess o **`null`** si hubo error.
- Los modos más comunes son **`FileAccess.READ`**, **`FileAccess.WRITE`** y **`FileAccess.READ_WRITE`** para controlar si se lee, se escribe o ambas cosas.

---

## Rutas útiles

- **`res://`** apunta al contenido del proyecto (escenas, scripts, assets) y normalmente sólo es de lectura en el juego exportado.
- **`user://`** es la carpeta de datos del usuario donde el juego puede crear y modificar archivos (ideal para saves y opciones).

## Ejemplo 1: Guardar texto simple

```python
func save_highscore(score: int) -> void:
    var path := "user://highscore.txt"
    var file := FileAccess.open(path, FileAccess.WRITE)
    if file == null:
        push_error("No se pudo abrir el archivo de highscore para escribir")
        return

    file.store_line(str(score))

```

## Ejemplo 2: Leer texto simple

```python
func load_highscore() -> int:
    var path := "user://highscore.txt"
    if not FileAccess.file_exists(path):
        return 0  # No hay archivo aún

    var file := FileAccess.open(path, FileAccess.READ)
    if file == null:
        push_error("No se pudo abrir el archivo de highscore para leer")
        return 0

    var line := file.get_line()
    return int(line)
```

## Ejemplo 3: Guardar Diccionario como JSON

```python
func save_game(data: Dictionary) -> void:
    var path := "user://savegame.json"
    var file := FileAccess.open(path, FileAccess.WRITE)
    if file == null:
        push_error("No se pudo abrir el archivo de guardado")
        return

    var json := JSON.stringify(data)  # Convierte el diccionario a texto JSON
    file.store_string(json)
```

## Ejemplo 4: Cargar Diccionario desde JSON:

```python
func load_game() -> Dictionary:
    var path := "user://savegame.json"
    var result := {}

    if not FileAccess.file_exists(path):
        return result  # Devuelve vacío si no hay archivo

    var file := FileAccess.open(path, FileAccess.READ)
    if file == null:
        push_error("No se pudo abrir el archivo de guardado")
        return result

    var text := file.get_as_text()
    var json := JSON.new()
    var err := json.parse(text)
    if err != OK:
        push_error("Error al parsear JSON de guardado")
        return result

    return json.get_data()
```

## Ejemplo 5: Escribir y Leer Binario

```python
func save_binary_value(value: int) -> void:
    var file := FileAccess.open("user://data.bin", FileAccess.WRITE)
    if file == null:
        return
    file.store_32(value)  # Guarda un entero de 32 bits

func load_binary_value() -> int:
    var path := "user://data.bin"
    if not FileAccess.file_exists(path):
        return 0

    var file := FileAccess.open(path, FileAccess.READ)
    if file == null:
        return 0

    return file.get_32()
```